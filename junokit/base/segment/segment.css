/* ===== SEGMENT GROUP (Container) ===== */
@layer components {
	.juno-segment-group {
		display: inline-flex;
		flex-direction: row;
		align-items: stretch;
		white-space: nowrap;
		user-select: none;
		position: relative;

		/* Padding system */
		--sg-padding: 0.5px;
		padding: var(--sg-padding);

		/* Radius system - size provides defaults, custom overrides */
		--sg-size-radius: var(--border-radius-md);
		--sg-radius: var(--sg-custom-radius, var(--sg-size-radius));

		border-radius: var(--sg-radius);
	}

	/* Size variants */
	.juno-segment-group-small {
		--sg-size-radius: var(--border-radius-sm);
		--sg-padding: 0.5px;
		font-size: 0.75rem;
		height: 1.75rem;
		outline: 0.5px solid var(--sg-outline-color, transparent);
		outline-offset: -0.5px;
	}

	.juno-segment-group-medium {
		--sg-size-radius: var(--border-radius-md);
		--sg-padding: 1px;
		font-size: 0.875rem;
		height: 2.25rem;
		outline: 1px solid var(--sg-outline-color, transparent);
		outline-offset: -1px;
	}

	.juno-segment-group-large {
		--sg-size-radius: var(--border-radius-lg);
		--sg-padding: 1px;
		font-size: 1rem;
		height: 3rem;
		outline: 1px solid var(--sg-outline-color, transparent);
		outline-offset: -1px;
	}

	/* Variant: light */
	.juno-segment-group-light {
		--sg-outline-color: color-mix(in srgb, currentColor 10%, transparent);
		background-color: color-mix(in srgb, currentColor 6%, transparent);
	}

	.juno-segment-group-light:hover {
		--sg-outline-color: color-mix(in srgb, currentColor 20%, transparent);
	}

	/* Variant: solid */
	.juno-segment-group-solid {
		--sg-outline-color: color-mix(in srgb, currentColor 20%, transparent);
		background-color: var(--base-50);
		box-shadow: inset 0 2px 4px 0 rgb(0 0 0 / 0.06);
		color: var(--base-content);
	}

	.juno-segment-group-solid:hover {
		--sg-outline-color: color-mix(in srgb, currentColor 30%, transparent);
	}

	/* Variant: soft (macOS style) */
	.juno-segment-group-soft {
		--sg-outline-color: transparent;
		--sg-padding: 2px;
		background-color: color-mix(in srgb, currentColor 6%, transparent);
	}

	.juno-segment-group-soft.juno-segment-group-small {
		--sg-padding: 1px;
	}

	.juno-segment-group-soft.juno-segment-group-large {
		--sg-padding: 3px;
	}

	/* Disabled state */
	.juno-segment-group-disabled {
		opacity: 0.5;
		cursor: not-allowed;
		pointer-events: none;
	}

	/* ===== SEGMENT (Individual option) ===== */

	.juno-segment {
		display: flex;
		flex-direction: row;
		align-items: center;
		justify-content: center;
		text-align: center;
		white-space: nowrap;
		user-select: none;
		cursor: pointer;
		transition: all 75ms;
		flex: 1 1 auto;
		align-self: stretch;
		position: relative;
		color: color-mix(in srgb, currentColor 60%, transparent);

		/* Radius system:
	   1. Use custom radius if segment has one
	   2. Else use group's radius minus padding */
		--segment-radius: var(--segment-custom-radius, calc(var(--sg-radius) - var(--sg-padding)));
	}

	/* Equal width segments */
	.juno-segment-group-equal {
		display: grid;
		grid-auto-flow: column;
		grid-auto-columns: minmax(max-content, 1fr);
	}

	.juno-segment-group-equal .juno-segment {
		min-width: 0;
	}

	/* ===== SEPARATORS ===== */

	/* Separator line between segments (only when separators enabled) */
	.juno-segment-group-separators .juno-segment:not(:last-child)::after {
		content: "";
		position: absolute;
		right: 0;
		top: 20%;
		bottom: 20%;
		width: 1px;
		background-color: var(--sg-separator-color);
		transition: all 75ms ease-out;
		z-index: 2;
	}

	/* Separator colors per variant */
	.juno-segment-group-light.juno-segment-group-separators {
		--sg-separator-color: color-mix(in srgb, currentColor 15%, transparent);
	}
	.juno-segment-group-solid.juno-segment-group-separators {
		--sg-separator-color: color-mix(in srgb, currentColor 15%, transparent);
	}
	.juno-segment-group-soft.juno-segment-group-separators {
		--sg-separator-color: color-mix(in srgb, currentColor 10%, transparent);
	}

	/* Hide separator when this segment or next segment is checked */
	.juno-segment-group-separators .juno-segment:has(input:checked)::after,
	.juno-segment-group-separators .juno-segment:has(+ .juno-segment input:checked)::after {
		opacity: 0;
	}

	/* Hidden input */
	.juno-segment-input {
		position: absolute;
		width: 1px;
		height: 1px;
		padding: 0;
		margin: -1px;
		overflow: hidden;
		clip: rect(0, 0, 0, 0);
		white-space: nowrap;
		border: 0;
	}

	/* Visual wrapper */
	.juno-segment-visual {
		display: flex;
		flex-direction: row;
		align-items: center;
		justify-content: center;
		gap: 0.5rem;
		height: 100%;
		width: 100%;
		transition:
			background-color 75ms,
			box-shadow 75ms,
			color 75ms;
		border-radius: var(--segment-radius);
		position: relative;
	}

	/* Size variants - padding and gap */
	.juno-segment-group-small .juno-segment-visual {
		padding-inline: clamp(3px, 0.625em, 10px);
		gap: 0.25rem;
	}

	.juno-segment-group-medium .juno-segment-visual {
		padding-inline: clamp(4px, 0.75em, 14px);
		gap: 0.5rem;
	}

	.juno-segment-group-large .juno-segment-visual {
		padding-inline: clamp(6px, 1em, 20px);
		gap: 0.75rem;
	}

	/* Hover state (when not checked) */
	.juno-segment:hover:not(:has(input:checked)) {
		color: color-mix(in srgb, currentColor 80%, transparent);
	}

	/* ===== CHECKED STATES (by variant) ===== */

	/* Light variant - checked */
	.juno-segment-group-light .juno-segment:has(input:checked) {
		color: var(--base-content);
	}

	.juno-segment-group-light .juno-segment:has(input:checked) .juno-segment-visual {
		background-color: var(--base-0);
		box-shadow:
			0 1px 3px 0 rgb(0 0 0 / 0.1),
			0 1px 2px -1px rgb(0 0 0 / 0.1);
		outline: 1px solid color-mix(in srgb, currentColor 20%, transparent);
		outline-offset: -1px;
	}

	.juno-segment-group-small.juno-segment-group-light .juno-segment:has(input:checked) .juno-segment-visual {
		box-shadow: 0 1px 2px 0 rgb(0 0 0 / 0.05);
		outline-width: 0.5px;
		outline-offset: -0.5px;
	}

	.juno-segment-group-light:hover .juno-segment:has(input:checked) .juno-segment-visual {
		outline-color: color-mix(in srgb, currentColor 24%, transparent);
	}

	/* Solid variant - checked */
	.juno-segment-group-solid .juno-segment:has(input:checked) {
		color: var(--base-0);
	}

	.juno-segment-group-solid .juno-segment:has(input:checked) .juno-segment-visual {
		background-color: var(--base-content);
		box-shadow:
			0 1px 3px 0 rgb(0 0 0 / 0.1),
			0 1px 2px -1px rgb(0 0 0 / 0.1);
	}

	/* Soft variant - checked */
	.juno-segment-group-soft .juno-segment:has(input:checked) {
		color: var(--base-content);
	}

	.juno-segment-group-soft .juno-segment:has(input:checked) .juno-segment-visual {
		background-color: var(--base-0);
		box-shadow:
			0 1px 3px 0 rgb(0 0 0 / 0.08),
			0 1px 2px -1px rgb(0 0 0 / 0.06);
	}

	/* ===== COLOR VARIANTS (checked state) ===== */

	/* For non-solid variants, use the focus color */
	.juno-segment-group-light .juno-segment-primary:has(input:checked),
	.juno-segment-group-soft .juno-segment-primary:has(input:checked) {
		color: var(--primary-focus);
	}

	.juno-segment-group-light .juno-segment-accent:has(input:checked),
	.juno-segment-group-soft .juno-segment-accent:has(input:checked) {
		color: var(--accent-focus);
	}

	/* For solid variant, text stays base-0 (white) */
	.juno-segment-group-solid .juno-segment-primary:has(input:checked),
	.juno-segment-group-solid .juno-segment-accent:has(input:checked) {
		color: var(--base-0);
	}

	/* ===== FOCUS STATES ===== */

	.juno-segment:has(input:focus-visible) .juno-segment-visual {
		outline: 2px solid color-mix(in srgb, currentColor 40%, transparent);
		outline-offset: 1px;
	}

	.juno-segment-primary:has(input:focus-visible) .juno-segment-visual {
		outline-color: color-mix(in srgb, var(--primary) 50%, transparent);
	}

	.juno-segment-accent:has(input:focus-visible) .juno-segment-visual {
		outline-color: color-mix(in srgb, var(--accent) 50%, transparent);
	}
}
